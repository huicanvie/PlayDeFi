
# 前言：别担心，这就是自动贩卖机

如果传统金融是一栋正襟危坐的银行大楼，DeFi 更像是一排摆在区块链上的“自动贩卖机”。  
你投进去一种资产，它按规则吐出另一种资产、借款额度，或者收益凭证；规则写在智能合约里，人人可查，不看脸色，不讲人情。

本人想做的，就是把这些“贩卖机”的说明书写得看得懂、用得上、避得坑。语气轻松点，但对于技术这件事，绝不打哈哈。

---

## DeFi 是啥

- **一句话**：在公开可验证的账本上，用智能合约提供金融服务，省去中介，但把信任交给代码与机制。
- **做市**：两桶水用一根管子连起来，左右倒来倒去，水位变动就是价格。
- **借贷**：把你家的黄金首饰品抵押在当铺，借走人民币。如果首饰品跌价或借太多，店家会把你的首饰品拍卖，防止你“吃完就跑”。
- **稳定币**：拿各种资产做背书，力求价值稳定可锚定。

---

## 为什么好用？同时又为什么容易翻车？

- **好用**：  
  - 24/7 不打烊，全球结算。
  - 开放接口，模块拼装。 
  - 规则透明，权限可审计。
- **也容易翻车**（且翻得响）：  
  - 技术层：重入、授权、预言机、非标准代币。
  - 经济层：价格操纵、无常损失、清算拥堵、激励错配。 
  - 治理层：单点多签、无延时升级、参数瞬变。  
  - 运维层：监控盲区、告警迟滞、应急剧本缺席。  
这四层像四道门槛，越往后越“看不见”，但只要摔一次就会痛很久。

---

## 你将读到

- **AMM DEX**：曲线、滑点、无常损失、MEV 的“文明相处之道”  
- **借贷协议**：抵押率、清算与利率曲线，如何避免“系统性坏账”  
- **稳定币**：超额抵押 vs 算法支撑，锚定守不住时的自救剧本  
- **预言机**：TWAP、外部喂价与容错融合，别把报价当成“圣旨”  
- **跨链与桥**：资产桥/消息桥的信任假设与限流策略  
- **治理与运维**：多签、时间锁、参数变更窗口与应急 

---

## 不是什么

- 不是《Solidity 完全手册》：语法点到为止，更多放在附录与参考链接。  
- 不是“稳赚不赔指南”：任何收益都有风险敞口，本书会把“副作用”写清楚。  
- 不是线上可直接部署的代码仓：**示例仅用于学习演示，严禁用于生产与承载真实资金。**

> **严肃提醒**：其中的示例为教学简化，缺少完备的风控、权限治理、非标准代币兼容与第三方审计。若要上线，请进行严格代码审查、属性/模糊测试、参数治理、监控与应急演练。不构成投资建议。

---

## 快速名词速食

- **AMM**：自动做市，曲线给价格，深度靠资金池。  
- **IL（无常损失）**：币价走位过大，LP 相对 hodl 会“略亏”。  
- **HF（健康因子）**：小于 1 就可能被清算。  
- **TWAP**：时间加权平均价，抗“当场作妖”。  
- **MEV**：区块打包的夹缝套利，防不住就要“相处”。  
- **Multisig/Timelock**：多签与延时，给变更留预留反悔时间。

---
